services:
  landlord-bff:
    build:
      context: ../../
      dockerfile: src/landlord/portal/bff/ProperTea.Landlord.Bff/Dockerfile.dev
    volumes:
      - ../../:/app
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - DOTNET_USE_POLLING_FILE_WATCHER=1
      - WAIT_FOR_DEBUGGER=${WAIT_FOR_DEBUGGER:-false}
    ports:
      - "5000:8080"
    entrypoint: >
      sh -c "
        if [ \"$$WAIT_FOR_DEBUGGER\" = 'true' ]; then
          echo '‚è≥ Waiting for debugger to attach...';
          exec dotnet run --project src/landlord/portal/bff/ProperTea.Landlord.Bff/ProperTea.Landlord.Bff.csproj --urls http://0.0.0.0:8080;
        else
          exec dotnet watch run --project src/landlord/portal/bff/ProperTea.Landlord.Bff/ProperTea.Landlord.Bff.csproj --urls http://0.0.0.0:8080;
        fi
      "

  landlord-web:
    build:
      context: ../../src/landlord/portal/web/propertea-landlord-portal
      dockerfile: Dockerfile.dev
    volumes:
      - ../../src/landlord/portal/web/propertea-landlord-portal:/app
      - /app/node_modules
    environment:
      - CHOKIDAR_USEPOLLING=true
    ports:
      - "4200:4200"
