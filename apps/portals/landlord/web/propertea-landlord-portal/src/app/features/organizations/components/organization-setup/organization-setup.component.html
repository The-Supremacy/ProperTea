<div class="flex justify-content-center align-items-center min-h-screen bg-gray-50">
  <p-card header="Setup Organization" styleClass="w-full max-w-30rem shadow-3">

    <form #form="ngForm" (ngSubmit)="onSubmit()" class="flex flex-column gap-4">

      <div class="flex flex-column gap-2">
        <label for="name" class="font-semibold">Organization Name</label>
        <input
          pInputText
          id="name"
          name="name"
          [ngModel]="name()"
          (ngModelChange)="onNameChange($event)"
          required
          minlength="3"
          #nameCtrl="ngModel"
          [class.ng-invalid]="nameCtrl.dirty && (nameCtrl.invalid || serverErrors()['name'])"
        />

        @if (nameCtrl.dirty && nameCtrl.invalid) {
          <small class="text-red-500">Name must be at least 3 characters.</small>
        }

        @if (serverErrors()['name']; as msg) {
          <small class="text-red-500">{{ msg }}</small>
        }
      </div>

      <div class="flex flex-column gap-2">
        <label for="slug" class="font-semibold">URL Slug</label>
        <div class="p-inputgroup">
          <span class="p-inputgroup-addon text-600">propertea.app/</span>
          <input
            pInputText
            id="slug"
            name="slug"
            [ngModel]="slug()"
            (ngModelChange)="onSlugChange($event)"
            required
            pattern="^[a-z0-9]+(?:-[a-z0-9]+)*$"
            #slugCtrl="ngModel"
            [class.ng-invalid]="slugCtrl.dirty && (slugCtrl.invalid || serverErrors()['slug'])"
          />
        </div>

        @if (isCheckingSlug()) {
           <small class="text-600 flex align-items-center mt-1">
             <i class="pi pi-spin pi-spinner mr-2"></i>Checking availability...
           </small>
        }
        @else if (slugCtrl.dirty) {
           @if (slugCtrl.hasError('pattern')) {
             <small class="text-red-500 mt-1">Lowercase letters, numbers, and hyphens only.</small>
           }
           @else if (slugAvailable() === false) {
             <small class="text-red-500 mt-1">This URL is already taken.</small>
           }
           @else if (slugAvailable() === true) {
             <small class="text-green-500 mt-1 flex align-items-center">
               <i class="pi pi-check mr-1"></i>Available
             </small>
           }
        }

        @if (serverErrors()['slug']; as msg) {
          <small class="text-red-500 mt-1">{{ msg }}</small>
        }
      </div>

      <p-button
        label="Create Organization"
        type="submit"
        [loading]="isSubmitting()"
        [disabled]="form.invalid || slugAvailable() === false || isCheckingSlug()"
        styleClass="w-full mt-2">
      </p-button>

    </form>
  </p-card>
</div>
