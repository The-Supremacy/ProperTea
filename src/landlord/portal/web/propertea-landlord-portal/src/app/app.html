<main class="main">
  <div class="container">
    <div class="header">
      <h1>ProperTea Landlord Portal</h1>
      <p>Modern Property Management Platform</p>
    </div>

    <!-- Loading State -->
    @if (authService.isLoading()) {
      <p-card>
        <p-skeleton width="100%" height="2rem" styleClass="mb-2"></p-skeleton>
        <p-skeleton width="80%" height="1.5rem"></p-skeleton>
      </p-card>
    }

    <!-- Not Authenticated -->
    @else if (!authService.isAuthenticated()) {
      <p-card>
        <ng-template pTemplate="header">
          <div class="card-header">
            <i class="pi pi-sign-in" style="font-size: 2rem"></i>
            <h2>Welcome!</h2>
          </div>
        </ng-template>

        <p class="text-center mb-4">
          Please sign in to access the landlord portal
        </p>

        <div class="button-group">
          <p-button
            label="Sign In"
            icon="pi pi-sign-in"
            severity="primary"
            (onClick)="authService.login()">
          </p-button>
        </div>
      </p-card>
    }

    <!-- Authenticated -->
    @else {
      <p-card>
        <ng-template pTemplate="header">
          <div class="card-header">
            <i class="pi pi-user" style="font-size: 2rem; color: var(--primary-color)"></i>
            <h2>Welcome, {{ authService.userName() }}!</h2>
          </div>
        </ng-template>

        <div class="user-info">
          @if (authService.userEmail()) {
            <div class="info-row">
              <i class="pi pi-envelope"></i>
              <span>{{ authService.userEmail() }}</span>
            </div>
          }

          <div class="info-row">
            <i class="pi pi-check-circle" style="color: var(--green-500)"></i>
            <span>Authenticated</span>
          </div>
        </div>

        <p-divider></p-divider>

        <div class="actions">
          <h3>Actions</h3>
          <div class="button-group">
            <p-button
              label="Edit Profile"
              icon="pi pi-user-edit"
              severity="secondary"
              (onClick)="authService.editProfile()">
            </p-button>

            <p-button
              label="Refresh"
              icon="pi pi-refresh"
              severity="secondary"
              [outlined]="true"
              (onClick)="authService.refresh()">
            </p-button>

            <p-button
              label="Sign Out"
              icon="pi pi-sign-out"
              severity="danger"
              [outlined]="true"
              (onClick)="authService.logout()">
            </p-button>
          </div>
        </div>

        <p-divider></p-divider>

        <!-- Token/Claims Display -->
        <div class="claims-section">
          <h3>User Claims (Token Contents)</h3>
          <div class="claims-container">
            @for (claim of authService.claims(); track claim.type) {
              <div class="claim-item">
                <span class="claim-type">{{ claim.type }}</span>
                <span class="claim-value">{{ claim.value }}</span>
              </div>
            }
          </div>
        </div>
      </p-card>
    }

    <router-outlet />
  </div>
</main>
