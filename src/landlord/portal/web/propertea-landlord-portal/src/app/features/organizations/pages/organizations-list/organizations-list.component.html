<div class="organizations-list">
  <p-card>
    <ng-template pTemplate="header">
      <div class="card-header">
        <h2>Organizations</h2>
        <p-button
          label="New Organization"
          icon="pi pi-plus"
          [routerLink]="['/organizations/new']">
        </p-button>
      </div>
    </ng-template>

    <!-- Search Bar -->
    <div class="search-bar">
      <span class="p-input-icon-left">
        <i class="pi pi-search"></i>
        <input
          pInputText
          type="text"
          placeholder="Search organizations..."
          (input)="onSearch($event)"
        />
      </span>
    </div>

    <!-- Organizations Table -->
    <p-table
      [value]="filteredOrganizations()"
      [loading]="isLoading()"
      [paginator]="true"
      [rows]="pageSize()"
      [totalRecords]="totalRecords()"
      [lazy]="true"
      (onLazyLoad)="onPageChange($event)"
      responsiveLayout="scroll">

      <ng-template pTemplate="header">
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Contact</th>
          <th>Status</th>
          <th style="width: 150px">Actions</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-org>
        <tr>
          <td>
            <strong>{{ org.name }}</strong>
          </td>
          <td>{{ org.description || '-' }}</td>
          <td>
            @if (org.contactEmail) {
              <div>{{ org.contactEmail }}</div>
            }
            @if (org.contactPhone) {
              <div class="text-secondary">{{ org.contactPhone }}</div>
            }
          </td>
          <td>
            <p-tag
              [value]="org.isActive ? 'Active' : 'Inactive'"
              [severity]="org.isActive ? 'success' : 'secondary'">
            </p-tag>
          </td>
          <td>
            <div class="action-buttons">
              <p-button
                icon="pi pi-eye"
                [routerLink]="['/organizations', org.id]"
                [text]="true"
                size="small">
              </p-button>
              <p-button
                icon="pi pi-pencil"
                [routerLink]="['/organizations', org.id, 'edit']"
                [text]="true"
                size="small">
              </p-button>
              <p-button
                icon="pi pi-trash"
                (onClick)="onDelete(org)"
                [text]="true"
                severity="danger"
                size="small">
              </p-button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="text-center">
            No organizations found
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>
