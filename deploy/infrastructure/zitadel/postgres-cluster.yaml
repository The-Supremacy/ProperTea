# local-path provisioner creates helper pods with hostPath volumes in this namespace.
# PSA must be privileged or the helper pod is rejected and PVC provisioning fails.
apiVersion: v1
kind: Namespace
metadata:
  name: zitadel
  labels:
    pod-security.kubernetes.io/enforce: privileged
    pod-security.kubernetes.io/warn: privileged
    pod-security.kubernetes.io/audit: privileged
---
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: zitadel-db
  namespace: zitadel
spec:
  instances: 1
  # Required: ZITADEL's init job needs the postgres superuser to CREATE DATABASE.
  # CNPG only creates the zitadel-db-superuser secret when this is enabled.
  enableSuperuserAccess: true
  storage:
    size: 5Gi
  bootstrap:
    initdb:
      database: zitadel
      owner: zitadel