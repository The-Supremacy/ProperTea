# Base ZITADEL Helm values â€” environment-agnostic.
# Env-specific values (ExternalDomain, replicaCount, FirstInstance credentials)
# live in deploy/environments/<env>/zitadel-values.yaml and are layered on top.

# Pin to v4.11.0+ which includes the PostgreSQL 18 compatibility fix
# (migration 34_add_cache_schema UNLOGGED partitioned table issue).
# See: https://github.com/zitadel/zitadel/issues/10712
image:
  tag: v4.11.1

zitadel:
  masterkeySecretName: zitadel-masterkey

  configmapConfig:
    ExternalPort: 443
    ExternalSecure: true

    TLS:
      Enabled: false

    Database:
      Postgres:
        Port: 5432
        Database: zitadel
        MaxOpenConns: 20
        MaxIdleConns: 20
        ConnMaxLifetime: 30m

    DefaultInstance:
      Features:
        LoginV2:
          Required: true

    OIDC:
      DefaultLoginURLV2: "/ui/v2/login/login?authRequest="
      DefaultLogoutURLV2: "/ui/v2/login/logout?post_logout_redirect="

    SAML:
      DefaultLoginURLV2: "/ui/v2/login/login?samlRequest="

login:
  enabled: true

service:
  type: ClusterIP
  port: 8080
  protocol: http2
